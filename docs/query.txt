A	B
a	a
a	a
a	a
a	-
-	b

3/5 = 0,6

SELECT word_id, count FROM site_word 

Result:

word_id  count site_id

SELECT t1.site_id AS site1, t2.site_id AS site2, t1.word_id AS word1, t2.word_id AS word2, t1.count AS count1, t2.count AS count2
	FROM site_word1 AS t1
	LEFT JOIN site_word1 AS t2
	ON t1.word_id = t2.word_id OR t1.word_id IS NULL OR t2.word_id IS NULL
	WHERE t1.site_id < t2.site_id

UNION

SELECT t1.site_id AS site1, t2.site_id AS site2, t1.word_id AS word1, t2.word_id AS word2, t1.count AS count1, t2.count AS count2
	FROM site_word1 AS t1
	RIGHT JOIN site_word1 AS t2
	ON t1.word_id = t2.word_id OR t1.word_id IS NULL OR t2.word_id IS NULL
	WHERE t1.site_id < t2.site_id
	
	
SELECT SUM(MIN_VALUE(sw1.count, sw2.count)) AS match 
	FROM site_words AS sw1
	INNER JOIN site_words AS sw2
	ON sw1.word_id = sw2.word_id
	WHERE sw1.site_id = $1 AND sw2.site_id = $2
	GROUP BY sw1.id
